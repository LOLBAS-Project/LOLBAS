Name: CL_LoadAssembly.ps1
Description: PowerShell Diagnostic Script
Author: Jimmy (@bohops)
Created: 2021-09-26
Commands:
- Command: "\u201Dpowershell.exe -command \"set-location -path C:\\Windows\\diagnostics\\\
    system\\Audio; import-module .\\CL_LoadAssembly.ps1; LoadAssemblyFromPath ..\\\
    ..\\..\\..\\testing\\fun.dll;[Program]::Fun()"
  Description: Proxy execute Managed DLL with PowerShell
  Usecase: Execute proxied payload with Microsoft signed binary
  Category: Execute
  Privileges: User
  MitreID: T1216
  OperatingSystem: Windows 10 21H1 (likely other versions as well)
Full_Path:
- Path: C:\Windows\diagnostics\system\Audio\CL_LoadAssembly.ps1
Code_Sample:
- Code: null
Detection:
- Sigma: https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/process_creation/win_susp_rundll32_activity.yml
- Splunk: https://github.com/splunk/security_content/blob/86a5b644a44240f01274c8b74d19a435c7dae66e/detections/endpoint/detect_rundll32_application_control_bypass___syssetup.yml
- Splunk: https://research.splunk.com/endpoint/71b9bf37-cde1-45fb-b899-1b0aa6fa1183/
Resources:
- Link: https://bohops.com/2018/01/07/executing-commands-and-bypassing-applocker-with-powershell-diagnostic-scripts/
Acknowledgement:
- Person: Jimmy
  Handle: '@bohops'
