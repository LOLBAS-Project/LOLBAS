---
Name: Winrs.exe
Description: WinRM can run commands on remote hosts. By omitting the remote endpoint, it can also run commands locally, spawning a child process under winrshost.exe.
Author: "Liran Ravich, CardinalOps"
Created: 2025-08-19

Commands:
  - Command: "winrs cmd /c whoami"
    Description: Run a command locally as a child process of winrshost.exe.
    Usecase: Run commands locally
    Category: Execute
    Privileges: "Remote Management Users or Local Admin"
    MitreID: T1218
    OperatingSystem: "Windows 10, Windows 11, Windows Server"
    Tags:
      - Name: Execute
        Value: CMD

Full_Path:
  - Path: C:\Windows\System32\Winrs.exe
  - Path: C:\Windows\SysWOW64\Winrs.exe

Detection:
  - Type: IOC
    Content: "Winrs.exe executed without -r, /r, -remote or /remote (no remote endpoint)"

Resources:
  - Link: "https://cardinalops.com/blog/living-off-winrm-abusing-complexity-in-remote-management/"
  - Link: "https://learn.microsoft.com/windows-server/administration/windows-commands/winrs"

Acknowledgement:
  - Person: "Liran Ravich, CardinalOps"
